FROM node:20-alpine

WORKDIR /app

# package.jsonとpackage-lock.jsonをコピー
COPY package*.json ./

# 全ての依存関係をインストール
RUN npm install

# ソースコードをコピー
COPY . .

EXPOSE 3001

# npx経由でtsxを実行（パスの問題を回避）
CMD ["npx", "tsx", "watch", "src/server.ts"]
